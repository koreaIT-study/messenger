<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/common.css">
    <link rel="stylesheet" href="/css/sign.css">
    <!-- <link rel="stylesheet" href="css/sub.css"> -->
    <title>Sign Up</title>
</head>

<body>
    <div class="sign_up_wrap">
        <div class="sign_up">
            <div class="sign_up_tit">
                <h1 class="tit_sign_up">
                    <span>íšŒì›ê°€ì…</span>
                </h1>
            </div>
            <!-- ë¡œê·¸ì¸  -->
            <div class="sign_up_body">
                <div class="sign_up_input" style="margin-top:10px;">
                    <div class="profile_img">
                        <!-- <img src="img/profile.jpg" alt=""> -->
                        <img src="/img/who.png" alt="">
                    </div>
                    <div>
                        <span>
                            <label class="file_button" for="profile_file">í”„ë¡œí•„ ì‚¬ì§„</label>
                            <input type="file" id="profile_file" style="display:none" />
                        </span>
                        <span>
                            <input type="text" id="name" name="name" placeholder="ì´ë¦„" title="ì´ë¦„" value="">
                        </span>
                        <span>
                            <input type="text" id="email" name="email" placeholder="ì´ë©”ì¼" title="ì´ë©”ì¼" value="" style="width: 56%;">
                            <button type="button" class="btn_sign_up" id="checkEmail" onclick="checkEmail()">ì´ë©”ì¼ í™•ì¸</button>
                        </span>
                        <span class="checkInput" style="display: none;">
                            <input type="text" id="authNumInput" placeholder="ì¸ì¦ë²ˆí˜¸ 6ìë¦¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”." style="width: 56%;">
                            <button type="button" class="btn_sign_up" id="checkAuthNumber" onclick="checkAuthNumber()">ì¸ì¦ë²ˆí˜¸ í™•ì¸</button>
                        </span>
                        <span>
                            <input type="password" name="password" id="password" placeholder="ë¹„ë°€ë²ˆí˜¸">
                        </span>
                        <span>
                            <input type="password" name="passwordCheck" id="passwordCheck" placeholder="ë¹„ë°€ë²ˆí˜¸í™•ì¸">
                        </span>
                    </div>
                    <div>
                        <button type="button" class="btn_sign_up" onclick="signUp()">ê°€ì…</button>
                    </div>
                </div>
            </div>

            <!-- OAUTH2  -->
            <div class="social_sign_up">

            </div>
        </div>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>

    <!-- ì „ì—­ë³€ìˆ˜ -->
    <script>
        const SignUp = {
            authNumber: undefined,
            vaildate: false
        }
    </script>

    <!-- ì´ë©”ì¼ ì¸ì¦ -->
    <script>
        function checkEmail() {
            const emailRegExp = /^[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*@[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*.[a-zA-Z]{2,3}$/i;
            const space = /\s/g;

            const email = document.querySelector('#email').value;
            const checkInput = document.querySelector('.checkInput');

            if(!emailRegExp.test(email) || !space.test(email)){
                alert("ì´ë©”ì¼í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.");
                return;
            }

            const param = {
                email
            }

            $.ajax({
                type : 'get',
                url : '/smtpRequest',
                data : param,
                success : function (response) {
                    console.log("ğŸš€ ~ file: sign_up.html ~ line 81 ~ checkEmail ~ response", response)
                    const errno = response.errno;

                    if(errno === 0){
                        checkInput.style.display = "block";
                        SignUp.authNumber = response.data;
                        alert('ì¸ì¦ë²ˆí˜¸ê°€ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.')
                    }else{
                        alert('ì²˜ë¦¬ë¥¼ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                    }
                }			
            });
        }

        function checkAuthNumber() {
            const inputNumber = document.querySelector('#authNumInput').value;

            if(inputNumber === SignUp.authNumber){
                alert('ì¸ì¦ë²ˆí˜¸ê°€ ì¼ì¹˜í•©ë‹ˆë‹¤.');
                SignUp.vaildate = true;
            }else{
                alert('ì¸ì¦ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                SignUp.vaildate = false;
            }
        }
    </script>

    <!-- íšŒì› ê°€ì… -->
    <script>
        const name = document.querySelector('#name').value;
        const email = document.querySelector('#email').value;
        const password = document.querySelector('#password').value;
        const passwordCheck = document.querySelector('#passwordCheck').value;
        if(password !== passwordCheck){
            alert("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
            return;
        }
        
        const param = {
            name,
            email,
            password
        }
        
        function signUp() {
            $.ajax({
                type : 'get',
                url : '/signUp',
                data : param,
                success : function (response) {
                    console.log("ğŸš€ ~ file: sign_up.html ~ line 81 ~ checkEmail ~ response", response)
                    const errno = response.errno;

                    if(errno === 0){
                        checkInput.style.display = "block";
                        SignUp.authNumber = response.data;
                        alert('ì¸ì¦ë²ˆí˜¸ê°€ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.')
                    }else{
                        alert('ì²˜ë¦¬ë¥¼ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                    }
                }			
            });
        }
    </script>
</body>

</html>